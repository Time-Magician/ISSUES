{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\yy\\\\Desktop\\\\fronted\\\\src\\\\view\\\\ListView.js\";\nimport React from 'react';\nimport { Link, withRouter } from \"react-router-dom\";\nimport '../css/Book.css';\nimport { Layout, List } from \"antd\";\nimport { HeaderInfo } from \"../components/HeaderInfo\";\nimport { SideBar } from \"../components/SideBar3\";\nimport { getBooks } from \"../services/bookService\";\nconst {\n  Header,\n  Content,\n  Footer\n} = Layout;\nconst Headers = [\"Book\", \"Type\", \"Author\", \"Price\"];\nconst Data = [['Java核心技术卷II', '编程', '凯S.霍斯特曼',, '95.20'], ['深入理解计算机系统', '编程', '兰德尔·E·布莱恩特', '136.90'], ['Effective C++', '编程', '梅耶', '51.30'], ['小王子', '儿童文学', '圣-埃克苏佩里', '8.89'], ['Java编程思想', '编程', 'Bruce Eckel', '91.20'], ['魔兽世界编年史套装(全三卷)', '魔幻小说', '克里斯˙梅森', '449.20'], ['三体：全三册', '科幻小说', '刘慈欣', '50.20'], ['悲惨世界（上中下）（精装版）', '世界名著', '雨果', '104.00'], ['动物农场', '社会小说', '乔治·奥威尔', '20.40'], ['机器学习', '编程', '周志华', '61.60'], ['纳尼亚传奇', '魔幻小说', '刘易斯', '86.20'], ['老人与海', '世界名著', '海明威', '27.80'], ['魔力的胎动', '悬疑/推理小说', '东野圭吾', '35.90']];\n\nclass LookView extends React.Component {\n  constructor(props) {\n    super(props);\n\n    this.sort = e => {\n      let column = e.target.cellIndex;\n      let data = this.state.data.slice();\n      let descending = this.state.sortby === column && !this.state.descending;\n      data.sort(function (a, b) {\n        return descending ? a[column] < b[column] ? 1 : -1 : a[column] > b[column] ? 1 : -1;\n      });\n      this.setState({\n        data: data,\n        sortby: column,\n        descending: descending\n      });\n    };\n\n    this.showEditor = e => {\n      this.setState({\n        edit: {\n          row: parseInt(e.target.dataset.row, 10),\n          cell: e.target.cellIndex\n        }\n      });\n    };\n\n    this.save = e => {\n      e.preventDefault();\n      let input = e.target.firstChild;\n      let data = this.state.data.slice();\n      data[this.state.edit.row][this.state.edit.cell] = input.value;\n      this.setState({\n        edit: null,\n        data: data\n      });\n    };\n\n    this.toggleSearch = () => {\n      if (this.state.search) {\n        this.setState({\n          data: this.preSearchData,\n          search: false\n        });\n        this.preSearchData = null;\n      } else {\n        this.preSearchData = this.state.data;\n        this.setState({\n          search: true\n        });\n      }\n    };\n\n    this.search = e => {\n      let needle = e.target.value.toLowerCase();\n\n      if (!needle) {\n        this.setState({\n          data: this.preSearchData\n        });\n        return;\n      }\n\n      let idx = e.target.dataset.idx;\n      let searchdata = this.preSearchData.filter(function (row) {\n        return row[idx].toString().toLowerCase().indexOf(needle) > -1;\n      });\n      this.setState({\n        data: searchdata\n      });\n    };\n\n    this.renderToolbar = () => {\n      return React.createElement(\"div\", {\n        className: \"toolbar\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 130\n        },\n        __self: this\n      }, React.createElement(\"div\", {\n        className: \"toolbar\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 149\n        },\n        __self: this\n      }, React.createElement(\"button\", {\n        onClick: this.toggleSearch,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 150\n        },\n        __self: this\n      }, \"Search\"), React.createElement(\"button\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 151\n        },\n        __self: this\n      }, React.createElement(\"a\", {\n        onClick: this.download.bind(this, 'json'),\n        href: \"data.json\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 152\n        },\n        __self: this\n      }, \"Export JSON\")), React.createElement(\"button\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 155\n        },\n        __self: this\n      }, React.createElement(\"a\", {\n        onClick: this.download.bind(this, 'csv'),\n        href: \"data.csv\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 156\n        },\n        __self: this\n      }, \"Export CSV\"))));\n    };\n\n    this.renderSearch = () => {\n      if (!this.state.search) {\n        return null;\n      }\n\n      return React.createElement(\"tr\", {\n        onChange: this.search,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 169\n        },\n        __self: this\n      }, this.state.header.map(function (ignore, idx) {\n        return React.createElement(\"td\", {\n          key: idx,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 171\n          },\n          __self: this\n        }, React.createElement(\"input\", {\n          type: \"text\",\n          \"data-idx\": idx,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 171\n          },\n          __self: this\n        }));\n      }));\n    };\n\n    this.renderTable = () => {\n      return React.createElement(\"div\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 179\n        },\n        __self: this\n      }, React.createElement(\"table\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 180\n        },\n        __self: this\n      }, React.createElement(\"thead\", {\n        onClick: this.sort,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 181\n        },\n        __self: this\n      }, React.createElement(\"tr\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 182\n        },\n        __self: this\n      }, this.state.header.map(function (title, idx) {\n        if (this.state.sortby === idx) {\n          title += this.state.descending ? ' \\u2191' : ' \\u2193';\n        }\n\n        return React.createElement(\"th\", {\n          key: idx,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 187\n          },\n          __self: this\n        }, title);\n      }, this))), React.createElement(\"tbody\", {\n        onDoubleClick: this.showEditor,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 191\n        },\n        __self: this\n      }, this.renderSearch(), this.state.data.map(function (row, rowidx) {\n        return React.createElement(\"tr\", {\n          key: rowidx,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 195\n          },\n          __self: this\n        }, row.map(function (cell, idx) {\n          let content = cell;\n          let edit = this.state.edit;\n\n          if (edit && edit.row === rowidx && edit.cell === idx) {\n            content = React.createElement(\"form\", {\n              onSubmit: this.save,\n              __source: {\n                fileName: _jsxFileName,\n                lineNumber: 201\n              },\n              __self: this\n            }, React.createElement(\"input\", {\n              type: \"text\",\n              defaultValue: cell,\n              __source: {\n                fileName: _jsxFileName,\n                lineNumber: 202\n              },\n              __self: this\n            }));\n          }\n\n          return React.createElement(\"td\", {\n            key: idx,\n            \"data-row\": rowidx,\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 207\n            },\n            __self: this\n          }, content);\n        }, this));\n      }, this))));\n    };\n\n    this.state = {\n      header: Headers,\n      data: Data,\n      sortby: null,\n      descending: false,\n      edit: null,\n      // [row index, cell index],\n      search: false,\n      preSearchData: null\n    };\n  }\n\n  download(format, ev) {\n    let contents = format === 'json' ? JSON.stringify(this.state.data) : this.state.data.reduce(function (result, row) {\n      return result + row.reduce(function (rowresult, cell, idx) {\n        return rowresult + '\"' + cell.replace(/\"/g, '\"\"') + '\"' + (idx < row.length - 1 ? ',' : '');\n      }, '') + \"\\n\";\n    }, '');\n    let URL = window.URL || window.webkitURL;\n    let blob = new Blob([contents], {\n      type: 'text/' + format\n    });\n    ev.target.href = URL.createObjectURL(blob);\n    ev.target.download = 'data.' + format;\n  }\n\n  render() {\n    return React.createElement(\"div\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 221\n      },\n      __self: this\n    }, React.createElement(Layout, {\n      className: \"layout\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 222\n      },\n      __self: this\n    }, React.createElement(Header, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 224\n      },\n      __self: this\n    }, React.createElement(HeaderInfo, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 225\n      },\n      __self: this\n    })), React.createElement(Layout, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 227\n      },\n      __self: this\n    }, React.createElement(SideBar, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 228\n      },\n      __self: this\n    }), this.renderToolbar(), this.renderTable())));\n  }\n\n}\n\nexport default withRouter(LookView);","map":{"version":3,"sources":["C:/Users/yy/Desktop/fronted/src/view/ListView.js"],"names":["React","Link","withRouter","Layout","List","HeaderInfo","SideBar","getBooks","Header","Content","Footer","Headers","Data","LookView","Component","constructor","props","sort","e","column","target","cellIndex","data","state","slice","descending","sortby","a","b","setState","showEditor","edit","row","parseInt","dataset","cell","save","preventDefault","input","firstChild","value","toggleSearch","search","preSearchData","needle","toLowerCase","idx","searchdata","filter","toString","indexOf","renderToolbar","download","bind","renderSearch","header","map","ignore","renderTable","title","rowidx","content","format","ev","contents","JSON","stringify","reduce","result","rowresult","replace","length","URL","window","webkitURL","blob","Blob","type","href","createObjectURL","render"],"mappings":"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","sourcesContent":["import React from 'react';\r\nimport {Link, withRouter} from \"react-router-dom\";\r\nimport '../css/Book.css';\r\nimport {Layout, List} from \"antd\";\r\nimport {HeaderInfo} from \"../components/HeaderInfo\";\r\nimport {SideBar} from \"../components/SideBar3\";\r\nimport {getBooks} from \"../services/bookService\";\r\n\r\nconst { Header, Content, Footer } = Layout;\r\n\r\nconst Headers = [\"Book\", \"Type\", \"Author\", \"Price\"];\r\n\r\n\r\nconst Data = [['Java核心技术卷II', '编程','凯S.霍斯特曼',, '95.20'],\r\n    ['深入理解计算机系统', '编程', '兰德尔·E·布莱恩特', '136.90'],\r\n['Effective C++', '编程', '梅耶', '51.30'],\r\n['小王子', '儿童文学', '圣-埃克苏佩里', '8.89'],\r\n['Java编程思想', '编程', 'Bruce Eckel', '91.20'],\r\n['魔兽世界编年史套装(全三卷)', '魔幻小说', '克里斯˙梅森', '449.20'],\r\n['三体：全三册', '科幻小说', '刘慈欣', '50.20'],\r\n['悲惨世界（上中下）（精装版）', '世界名著', '雨果', '104.00'],\r\n['动物农场', '社会小说', '乔治·奥威尔', '20.40'],\r\n['机器学习', '编程', '周志华', '61.60'],\r\n['纳尼亚传奇', '魔幻小说', '刘易斯', '86.20'],\r\n['老人与海', '世界名著', '海明威', '27.80'],\r\n['魔力的胎动', '悬疑/推理小说', '东野圭吾', '35.90',]];\r\n\r\nclass LookView extends React.Component{\r\n\r\n    constructor(props) {\r\n        super(props);\r\n        this.state = {\r\n            header:Headers,\r\n            data: Data,\r\n            sortby: null,\r\n            descending: false,\r\n            edit: null, // [row index, cell index],\r\n            search: false,\r\n            preSearchData: null,\r\n        };\r\n    }\r\n\r\n    sort = (e) => {\r\n        let column = e.target.cellIndex;\r\n        let data = this.state.data.slice();\r\n        let descending = this.state.sortby === column && !this.state.descending;\r\n        data.sort(function (a, b) {\r\n            return descending\r\n                ? (a[column] < b[column] ? 1 : -1)\r\n                : (a[column] > b[column] ? 1 : -1);\r\n        });\r\n        this.setState({\r\n            data: data,\r\n            sortby: column,\r\n            descending: descending,\r\n        });\r\n    };\r\n\r\n    showEditor = (e) => {\r\n        this.setState({\r\n            edit: {\r\n                row: parseInt(e.target.dataset.row, 10),\r\n                cell: e.target.cellIndex,\r\n            }\r\n        });\r\n    };\r\n\r\n    save = (e) => {\r\n        e.preventDefault();\r\n        let input = e.target.firstChild;\r\n        let data = this.state.data.slice();\r\n        data[this.state.edit.row][this.state.edit.cell] = input.value;\r\n        this.setState({\r\n            edit: null,\r\n            data: data,\r\n        });\r\n    };\r\n\r\n    toggleSearch = () => {\r\n        if (this.state.search) {\r\n            this.setState({\r\n                data: this.preSearchData,\r\n                search: false,\r\n            });\r\n            this.preSearchData = null;\r\n        } else {\r\n            this.preSearchData = this.state.data;\r\n            this.setState({\r\n                search: true,\r\n            });\r\n        }\r\n    };\r\n\r\n    search = (e) => {\r\n        let needle = e.target.value.toLowerCase();\r\n        if (!needle) {\r\n            this.setState({data: this.preSearchData});\r\n            return;\r\n        }\r\n        let idx = e.target.dataset.idx;\r\n        let searchdata = this.preSearchData.filter(function (row) {\r\n            return row[idx].toString().toLowerCase().indexOf(needle) > -1;\r\n        });\r\n        this.setState({data: searchdata});\r\n    };\r\n\r\n    download(format, ev) {\r\n        let contents = format === 'json'\r\n            ? JSON.stringify(this.state.data)\r\n            : this.state.data.reduce(function (result, row) {\r\n                return result\r\n                    + row.reduce(function (rowresult, cell, idx) {\r\n                        return rowresult\r\n                            + '\"'\r\n                            + cell.replace(/\"/g, '\"\"')\r\n                            + '\"'\r\n                            + (idx < row.length - 1 ? ',' : '');\r\n                    }, '')\r\n                    + \"\\n\";\r\n            }, '');\r\n\r\n        let URL = window.URL || window.webkitURL;\r\n        let blob = new Blob([contents], {type: 'text/' + format});\r\n        ev.target.href = URL.createObjectURL(blob);\r\n        ev.target.download = 'data.' + format;\r\n    };\r\n\r\n    renderToolbar = () => {\r\n        return (\r\n            <div className=\"toolbar\">\r\n                {/*<nav className=\"navbar navbar-default\" role=\"navigation\">*/}\r\n                {/*    <div className=\"container-fluid\">*/}\r\n                {/*        <div className=\"navbar-header\">*/}\r\n                {/*            <a className=\"navbar-brand\" href=\"#\">e-Book</a>*/}\r\n                {/*        </div>*/}\r\n                {/*        <div>*/}\r\n                {/*            <ul className=\"nav navbar-nav\">*/}\r\n                {/*                <li className=\"active\"><a href=\"#\">图书浏览</a></li>*/}\r\n                {/*            </ul>*/}\r\n\r\n                {/*            <form className=\"navbar-form navbar-right\" role=\"search\">*/}\r\n                {/*                <button type=\"primary\" className=\"btn btn-default\">*/}\r\n                {/*                    <Link to=\"\">返回主页</Link>*/}\r\n                {/*                </button>*/}\r\n                {/*            </form>*/}\r\n                {/*        </div>*/}\r\n                {/*    </div>*/}\r\n                {/*</nav>*/}\r\n                <div className=\"toolbar\">\r\n                    <button onClick={this.toggleSearch}>Search</button>\r\n                    <button>\r\n                    <a onClick={this.download.bind(this, 'json')}\r\n                       href=\"data.json\">Export JSON</a>\r\n                    </button>\r\n                    <button>\r\n                    <a onClick={this.download.bind(this, 'csv')}\r\n                       href=\"data.csv\">Export CSV</a>\r\n                    </button>\r\n                </div>\r\n            </div>\r\n        );\r\n    };\r\n\r\n    renderSearch = () =>  {\r\n        if (!this.state.search) {\r\n            return null;\r\n        }\r\n        return (\r\n            <tr onChange={this.search}>\r\n                {this.state.header.map(function (ignore, idx) {\r\n                    return <td key={idx}><input type=\"text\" data-idx={idx}/></td>;\r\n                })}\r\n            </tr>\r\n        );\r\n    };\r\n\r\n    renderTable = () => {\r\n        return (\r\n            <div>\r\n            <table>\r\n                <thead onClick={this.sort}>\r\n                <tr>{\r\n                    this.state.header.map(function (title, idx) {\r\n                        if (this.state.sortby === idx) {\r\n                            title += this.state.descending ? ' \\u2191' : ' \\u2193';\r\n                        }\r\n                        return <th key={idx}>{title}</th>;\r\n                    }, this)\r\n                }</tr>\r\n                </thead>\r\n                <tbody onDoubleClick={this.showEditor}>\r\n                {this.renderSearch()}\r\n                {this.state.data.map(function (row, rowidx) {\r\n                    return (\r\n                        <tr key={rowidx}>{\r\n                            row.map(function (cell, idx) {\r\n                                let content = cell;\r\n                                let edit = this.state.edit;\r\n                                if (edit && edit.row === rowidx && edit.cell === idx) {\r\n                                    content = (\r\n                                        <form onSubmit={this.save}>\r\n                                            <input type=\"text\" defaultValue={cell}/>\r\n                                        </form>\r\n                                    );\r\n                                }\r\n\r\n                                return <td key={idx} data-row={rowidx}>{content}</td>;\r\n                            }, this)}\r\n                        </tr>\r\n                    );\r\n                }, this)}\r\n                </tbody>\r\n            </table>\r\n            </div>\r\n        );\r\n    }\r\n\r\n\r\n    render(){\r\n        return(\r\n            <div>\r\n                <Layout className=\"layout\">\r\n\r\n                    <Header>\r\n                        <HeaderInfo />\r\n                    </Header>\r\n                    <Layout>\r\n                        <SideBar />\r\n                        {this.renderToolbar()}\r\n                        {this.renderTable()}\r\n                    </Layout>\r\n                </Layout>\r\n            </div>\r\n        )\r\n\r\n    }\r\n\r\n}\r\n\r\nexport default withRouter(LookView);"]},"metadata":{},"sourceType":"module"}