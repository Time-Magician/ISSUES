{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\yy\\\\Desktop\\\\fronted\\\\src\\\\LoginRoute.js\";\nimport React from 'react';\nimport { Route, Redirect } from 'react-router-dom';\nimport * as userService from \"./services/userService\";\nimport { message } from \"antd\";\nexport class LoginRoute extends React.Component {\n  constructor(props) {\n    super(props);\n\n    this.checkAuth = data => {\n      console.log(data);\n\n      if (data.status >= 0) {\n        this.setState({\n          isAuthed: true,\n          hasAuthed: true\n        });\n      } else {\n        localStorage.removeItem('user');\n        this.setState({\n          isAuthed: false,\n          hasAuthed: true\n        });\n      }\n    };\n\n    this.state = {\n      isAuthed: false,\n      hasAuthed: false\n    };\n  }\n\n  componentDidMount() {\n    userService.checkSession(this.checkAuth);\n  }\n\n  render() {\n    const {\n      component: Component,\n      path = \"/\",\n      exact = false,\n      strict = false\n    } = this.props;\n    console.log(this.state.isAuthed);\n\n    if (!this.state.hasAuthed) {\n      return null;\n    }\n\n    return React.createElement(Route, {\n      path: path,\n      exact: exact,\n      strict: strict,\n      render: props => this.state.isAuthed ? React.createElement(Redirect, {\n        to: {\n          pathname: '/',\n          state: {\n            from: props.location\n          }\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 43\n        },\n        __self: this\n      }) : React.createElement(Component, Object.assign({}, props, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 48\n        },\n        __self: this\n      })),\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 41\n      },\n      __self: this\n    });\n  }\n\n}\nexport default LoginRoute;","map":{"version":3,"sources":["C:/Users/yy/Desktop/fronted/src/LoginRoute.js"],"names":["React","Route","Redirect","userService","message","LoginRoute","Component","constructor","props","checkAuth","data","console","log","status","setState","isAuthed","hasAuthed","localStorage","removeItem","state","componentDidMount","checkSession","render","component","path","exact","strict","pathname","from","location"],"mappings":";AAAA,OAAOA,KAAP,MAAkB,OAAlB;AACA,SAAQC,KAAR,EAAeC,QAAf,QAA8B,kBAA9B;AACA,OAAO,KAAKC,WAAZ,MAA6B,wBAA7B;AACA,SAAQC,OAAR,QAAsB,MAAtB;AAEA,OAAO,MAAMC,UAAN,SAAyBL,KAAK,CAACM,SAA/B,CAAwC;AAC3CC,EAAAA,WAAW,CAACC,KAAD,EAAQ;AACf,UAAMA,KAAN;;AADe,SAQnBC,SARmB,GAQNC,IAAD,IAAU;AAClBC,MAAAA,OAAO,CAACC,GAAR,CAAYF,IAAZ;;AACA,UAAIA,IAAI,CAACG,MAAL,IAAe,CAAnB,EAAsB;AAClB,aAAKC,QAAL,CAAc;AAACC,UAAAA,QAAQ,EAAE,IAAX;AAAiBC,UAAAA,SAAS,EAAE;AAA5B,SAAd;AACH,OAFD,MAEO;AACHC,QAAAA,YAAY,CAACC,UAAb,CAAwB,MAAxB;AACA,aAAKJ,QAAL,CAAc;AAACC,UAAAA,QAAQ,EAAE,KAAX;AAAkBC,UAAAA,SAAS,EAAE;AAA7B,SAAd;AACH;AACJ,KAhBkB;;AAEf,SAAKG,KAAL,GAAa;AACTJ,MAAAA,QAAQ,EAAE,KADD;AAETC,MAAAA,SAAS,EAAE;AAFF,KAAb;AAIH;;AAaDI,EAAAA,iBAAiB,GAAG;AAChBjB,IAAAA,WAAW,CAACkB,YAAZ,CAAyB,KAAKZ,SAA9B;AACH;;AAGDa,EAAAA,MAAM,GAAG;AAEL,UAAM;AAACC,MAAAA,SAAS,EAAEjB,SAAZ;AAAuBkB,MAAAA,IAAI,GAAC,GAA5B;AAAgCC,MAAAA,KAAK,GAAC,KAAtC;AAA4CC,MAAAA,MAAM,GAAC;AAAnD,QAA4D,KAAKlB,KAAvE;AAEAG,IAAAA,OAAO,CAACC,GAAR,CAAY,KAAKO,KAAL,CAAWJ,QAAvB;;AAEA,QAAI,CAAC,KAAKI,KAAL,CAAWH,SAAhB,EAA2B;AACvB,aAAO,IAAP;AACH;;AAED,WAAO,oBAAC,KAAD;AAAO,MAAA,IAAI,EAAEQ,IAAb;AAAmB,MAAA,KAAK,EAAEC,KAA1B;AAAiC,MAAA,MAAM,EAAEC,MAAzC;AAAiD,MAAA,MAAM,EAAElB,KAAK,IACjE,KAAKW,KAAL,CAAWJ,QAAX,GACI,oBAAC,QAAD;AAAU,QAAA,EAAE,EAAE;AACVY,UAAAA,QAAQ,EAAE,GADA;AAEVR,UAAAA,KAAK,EAAE;AAACS,YAAAA,IAAI,EAAEpB,KAAK,CAACqB;AAAb;AAFG,SAAd;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,QADJ,GAMI,oBAAC,SAAD,oBAAerB,KAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SAPD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MAAP;AAUH;;AA7C0C;AAgD/C,eAAeH,UAAf","sourcesContent":["import React from 'react';\r\nimport {Route, Redirect} from 'react-router-dom'\r\nimport * as userService from \"./services/userService\"\r\nimport {message} from \"antd\";\r\n\r\nexport class LoginRoute extends React.Component{\r\n    constructor(props) {\r\n        super(props);\r\n        this.state = {\r\n            isAuthed: false,\r\n            hasAuthed: false,\r\n        };\r\n    }\r\n\r\n    checkAuth = (data) => {\r\n        console.log(data);\r\n        if (data.status >= 0) {\r\n            this.setState({isAuthed: true, hasAuthed: true});\r\n        } else {\r\n            localStorage.removeItem('user');\r\n            this.setState({isAuthed: false, hasAuthed: true});\r\n        }\r\n    };\r\n\r\n\r\n    componentDidMount() {\r\n        userService.checkSession(this.checkAuth);\r\n    }\r\n\r\n\r\n    render() {\r\n\r\n        const {component: Component, path=\"/\",exact=false,strict=false} = this.props;\r\n\r\n        console.log(this.state.isAuthed);\r\n\r\n        if (!this.state.hasAuthed) {\r\n            return null;\r\n        }\r\n\r\n        return <Route path={path} exact={exact} strict={strict} render={props => (\r\n            this.state.isAuthed ? (\r\n                <Redirect to={{\r\n                    pathname: '/',\r\n                    state: {from: props.location}\r\n                }}/>\r\n            ) : (\r\n                <Component {...props}/>\r\n            )\r\n        )}/>\r\n    }\r\n}\r\n\r\nexport default LoginRoute"]},"metadata":{},"sourceType":"module"}